#+TITLE: 渲染
#+DATE:<2022-06-29 Wed 15:54>
#+FILETAGS: browser

* Render Pipeline[fn:2]

[[file:BrowserRenderingPipeline01.png]]

** Layout

又可称之为 Reflow

计算元素的几何尺寸，坐标位置，更改 width, height, position 等属性会 relayout，比较耗时

** Paint

将 render tree 绘制到页面上

绘制像素，更改 box-shadow, background-color, text-color 等属性会 repaint

** Render tree

Each node typically references a DOM node and a Computed Style

** Main thread[fn:3]

在主线程上执行的任务(Tasks)有

1. HTML, CSS 解析
2. 用户事件响应（e.g. click)
3. js 代码执行
4. 接受网络数据
5. render steps ( style, layout, paint )

   render steps 结束后，得到一帧 Frame

[[file:EventLoop06.png]]

** Task queue

任务队列，主线程繁忙时，task 进入到这里

* CSR

Client Side Render

* SSR

Server Side Render

* ISR

增量静态重构建[fn:1]

仅针对变动的 page 进行构建，而不是全量构建

* 参考

[fn:1] [[https://nextjs.org/docs/basic-features/data-fetching/incremental-static-regeneration][Incremental Static Regeneration]]
[fn:2] [[https://www.webperf.tips/tip/browser-rendering-pipeline/][browser render pipeline]]
[fn:3][[https://www.webperf.tips/tip/event-loop/][ event loop]]
